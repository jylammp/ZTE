3,358,4,2
4,97,8,74
1,486,9,97
2,465,9,58
0,208,10,20

3,0,4
4,0,8
1,0,9
2,1,9
0,0,10

这段代码的时间复杂度主要集中在处理流信息的部分，其中最耗时的操作是查找最早可用端口的过程。可以通过一些优化来降低时间复杂度。

使用堆来维护可用端口列表
在查找最早可用端口时，需要遍历所有端口，找到带宽足够且最早被占用的端口。这个过程可以使用堆来优化，将所有可用端口按最早占用时间排序，每次取出堆顶端口即为最早可用端口。使用堆的时间复杂度为 $O(log n)$。

使用字典来快速查找端口
在使用堆来维护可用端口列表时，需要在堆中查找某个端口是否存在。这个过程可以使用字典来优化，将端口编号作为字典的键，端口对象作为值，可以在 $O(1)$ 的时间复杂度内查找某个端口是否存在。

使用字典来快速查找流
在更新端口信息时，需要遍历端口已占用的流列表，计算已占用带宽和空闲带宽。这个过程可以使用字典来优化，将端口对象作为字典的键，已占用带宽列表作为值，每次更新端口信息时只需要查询端口对应的已占用带宽列表，可以在 $O(1)$ 的时间复杂度内完成。

写出优化后的代码：